(function(o){var c=[];var d={init:function(m){return this.each(function(){var s=this;var n=o(s).data("cbdatepicker");if(n){return}n={};n.options=typeof m!="undefined"?m:{};n.defaults=o.fn.cbdatepicker.defaults;n.settings=o.extend(true,{},n.defaults,n.options);n.strings=o.extend(true,{},o.datepicker.regional[""],n.settings.strings);n.element=o(s);if(n.settings.useData){o.each(n.defaults,function(e,t){if(e!="init"&&e!="useData"){var s=n.element.data("cbdatepicker"+e.charAt(0).toUpperCase()+e.slice(1));if(typeof s!="undefined"){n.settings[e]=s}else{s=n.element.data("cbdatepicker"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase());if(typeof s!="undefined"){n.settings[e]=s}}}})}n.element.triggerHandler("cbdatepicker.init.before",[n]);if(!n.settings.init){return}var i=(new Date).getFullYear();if(n.settings.minYear){if(typeof n.settings.minYear=="string"){var e=n.settings.minYear.substr(0,1);var t=n.settings.minYear.substr(1);if(e=="+"){n.settings.minYear=i+parseInt(t)}else if(e=="-"){n.settings.minYear=i-parseInt(t)}}}else{n.settings.minYear=i-99}if(n.settings.maxYear){if(typeof n.settings.maxYear=="string"){var a=n.settings.maxYear.substr(0,1);var r=n.settings.maxYear.substr(1);if(a=="+"){n.settings.maxYear=i+parseInt(r)}else if(a=="-"){n.settings.maxYear=i-parseInt(r)}}}else{n.settings.maxYear=i+99}if(n.settings.calendarType==2||n.settings.calendarType==3){var l=null;if(typeof moment!="undefined"){l=moment.locale();moment.locale(Math.random(),{months:n.strings.monthNames,monthsShort:n.strings.monthNamesShort,weekdays:n.strings.dayNames,weekdaysShort:n.strings.dayNamesShort,weekdaysMin:n.strings.dayNamesMin})}n.combodate=n.element.combodate({format:n.settings.format,template:n.settings.template,minYear:n.settings.minYear,maxYear:n.settings.maxYear,firstItem:n.settings.firstItem,smartDays:true,yearDescending:false,minuteStep:1,secondStep:1,customClass:n.settings.customClass});if(l){moment.locale(l)}n.element.siblings(".combodate").children().on("change",function(e){var t=o(this).val();if(t!==""){o(this).siblings().each(function(){if(!o(this).val()){var e=null;if(o(this).hasClass("year")){e=o(this).children('option[value="'+i+'"]').val()}if(!e){e=o(this).children('option[value!=""]:first').val()}if(e){o(this).val(e)}}})}else{o(this).siblings().each(function(){o(this).val("")})}n.element.triggerHandler("cbdatepicker.select",[n,n.element.combodate("getValue")])})}if(n.settings.calendarType==1||n.settings.calendarType==4||n.settings.addPopup){if(n.settings.showTime){n.datetimepicker=n.element.datetimepicker({showAnim:"",showHour:n.settings.timeTemplate.toLowerCase().indexOf("h")!==-1,showMinute:n.settings.timeTemplate.toLowerCase().indexOf("m")!==-1,showSecond:n.settings.timeTemplate.toLowerCase().indexOf("s")!==-1,showMillisec:n.settings.timeTemplate.toLowerCase().indexOf("l")!==-1,showMicrosec:n.settings.timeTemplate.toLowerCase().indexOf("c")!==-1,stepMinute:1,stepSecond:1,altFieldTimeOnly:false,altTimeFormat:n.settings.calendarType==1||n.settings.calendarType==4?n.settings.timeFormat:null,timeFormat:n.settings.calendarType==1||n.settings.calendarType==4?n.settings.timeTemplate:n.settings.timeFormat,pickerTimeFormat:n.settings.timeTemplate,amNames:n.strings.amNames,pmNames:n.strings.pmNames,timeOnly:n.settings.timeOnly,timeOnlyTitle:n.strings.timeOnlyTitle,timeText:n.strings.timeText,hourText:n.strings.hourText,minuteText:n.strings.minuteText,secondText:n.strings.secondText,millisecText:n.strings.millisecText,microsecText:n.strings.microsecText,timezoneText:n.strings.timezoneText,onSelect:function(e){if(n.settings.addPopup){n.element.combodate("setValue",e)}else{n.element.change()}if(n.settings.calendarType==4){n.element.siblings(".cbDatePickerSelected").html(e)}n.element.triggerHandler("cbdatepicker.select",[n,e])},yearRange:n.settings.minYear+":"+n.settings.maxYear,isRTL:n.settings.isRTL,firstDay:n.settings.firstDay,changeMonth:true,changeYear:true,showButtonPanel:false,altField:n.settings.calendarType==1||n.settings.calendarType==4?n.settings.target:null,altFormat:n.settings.calendarType==1||n.settings.calendarType==4?n.settings.dateFormat:null,dateFormat:n.settings.calendarType==1||n.settings.calendarType==4?n.settings.dateTemplate:n.settings.dateFormat,dayNames:n.strings.dayNames,dayNamesMin:n.strings.dayNamesMin,dayNamesShort:n.strings.dayNamesShort,monthNames:n.strings.monthNames,monthNamesShort:n.strings.monthNamesShort,prevText:n.strings.prevText,nextText:n.strings.nextText,currentText:n.strings.currentText,closeText:n.strings.closeText})}else{n.datepicker=n.element.datepicker({onSelect:function(e){if(n.settings.addPopup){n.element.combodate("setValue",e)}else{n.element.change()}if(n.settings.calendarType==4){n.element.siblings(".cbDatePickerSelected").html(e)}n.element.triggerHandler("cbdatepicker.select",[n,e])},showAnim:"",yearRange:n.settings.minYear+":"+n.settings.maxYear,isRTL:n.settings.isRTL,firstDay:n.settings.firstDay,changeMonth:true,changeYear:true,showButtonPanel:false,altField:n.settings.calendarType==1||n.settings.calendarType==4?n.settings.target:null,altFormat:n.settings.calendarType==1||n.settings.calendarType==4?n.settings.dateFormat:null,dateFormat:n.settings.calendarType==1||n.settings.calendarType==4?n.settings.dateTemplate:n.settings.dateFormat,dayNames:n.strings.dayNames,dayNamesMin:n.strings.dayNamesMin,dayNamesShort:n.strings.dayNamesShort,monthNames:n.strings.monthNames,monthNamesShort:n.strings.monthNamesShort,prevText:n.strings.prevText,nextText:n.strings.nextText,currentText:n.strings.currentText,closeText:n.strings.closeText})}}n.calendarHandler=function(e){e.preventDefault();var t=n.element.datepicker("widget");if(t.not(":visible").length){n.element.datepicker("show");t.position({my:"left top+20",at:"left top",of:o(this)});if(t.css("z-index")<100){t.css("z-index",100)}}n.element.triggerHandler("cbdatepicker.calendar",[n])};n.element.siblings(".cbDatePickerCalendar").on("click",n.calendarHandler);n.changeHandler=function(e){var t=o(this);if(n.settings.target){t=o(n.settings.target)}t.val(d.get.call(s))};n.element.on("change",n.changeHandler);n.element.on("remove.cbdatepicker destroy.cbdatepicker",function(){n.element.cbdatepicker("destroy")});n.element.on("rebind.cbdatepicker",function(){n.element.cbdatepicker("rebind")});n.element.on("modified.cbdatepicker",function(e,t,s,i){if(t!=s){n.element.cbdatepicker("rebind")}});n.element.on("cloned.cbdatepicker",function(){o(this).off(".cbdatepicker");o(this).removeData("cbdatepicker");o(this).removeData("combodate");o(this).removeData("datepicker");o(this).siblings(".combodate").remove();o(this).removeClass("hasDatepicker");o(this).siblings(".cbDatePickerCalendar").off("click",n.calendarHandler);o(this).off("change",n.changeHandler);o(this).cbdatepicker(n.options)});n.element.triggerHandler("cbdatepicker.init.after",[n]);n.element.data("cbdatepicker",n);c.push(n)})},get:function(){var e=o(this).data("cbdatepicker");if(!e){return""}var t="";if(e.settings.calendarType==2||e.settings.calendarType==3){if(e.settings.showTime){t=o(this).combodate("getValue","YYYY-MM-DD HH:mm:ss")}else{t=o(this).combodate("getValue","YYYY-MM-DD")}}else if(e.settings.calendarType==1||e.settings.calendarType==4){if(e.settings.showTime){t=o(this).datetimepicker("getDate");if(t){t=new Date(t).toSQLDateTimeString()}}else{t=o(this).datepicker("getDate");if(t){t=new Date(t).toSQLDateString()}}}if(t&&typeof moment!="undefined"){var s=false;if(e.settings.showTime&&e.settings.offset){t=t+e.settings.offset;s=true}var i=moment(t);if(!s&&e.settings.showTime&&e.settings.timezone&&e.settings.timezone!="UTC"&&typeof moment.tz!="undefined"){i=moment.tz(t,e.settings.timezone);s=true}if(i.isValid()){if(s){i.utc()}t=i.format(e.settings.format)}else{t=""}}else{t=""}return t},set:function(e){var t=o(this).data("cbdatepicker");if(!t){return this}if(t.settings.calendarType==2||t.settings.calendarType==3){o(this).combodate("setValue",e)}else if(t.settings.calendarType==1||t.settings.calendarType==4){if(t.settings.showTime){o(this).datetimepicker("setDate",e)}else{o(this).datepicker("setDate",e)}}return this},rebind:function(){var e=o(this).data("cbdatepicker");if(!e){return this}e.element.cbdatepicker("destroy");e.element.cbdatepicker(e.options);return this},destroy:function(){var s=o(this).data("cbdatepicker");if(!s){return this}if(s.combodate){s.element.combodate("destroy")}if(s.datetimepicker){s.element.datetimepicker("destroy")}if(s.datepicker){s.element.datepicker("destroy")}s.element.siblings(".cbDatePickerCalendar").off("click",s.calendarHandler);s.element.off("change",s.changeHandler);s.element.off(".cbdatepicker");o.each(c,function(e,t){if(t.element==s.element){c.splice(e,1);return false}return true});s.element.removeData("cbdatepicker");s.element.triggerHandler("cbdatepicker.destroyed",[s]);return this},instances:function(){return c}};function e(e){if(e<10){return"0"+e}return e}if(!Date.prototype.toSQLDateString){Date.prototype.toSQLDateString=function(){return this.getFullYear()+"-"+e(this.getMonth()+1)+"-"+e(this.getDate())}}if(!Date.prototype.toSQLDateTimeString){Date.prototype.toSQLDateTimeString=function(){return this.getFullYear()+"-"+e(this.getMonth()+1)+"-"+e(this.getDate())+" "+e(this.getHours())+":"+e(this.getMinutes())+":"+e(this.getSeconds())}}o.fn.cbdatepicker=function(e){if(d[e]){return d[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return d.init.apply(this,arguments)}return this};o.fn.cbdatepicker.defaults={init:true,useData:true,calendarType:2,template:"MM / DD / YYYY HH : mm : ss",format:"YYYY-MM-DD HH:mm:ss",timeTemplate:"HH:mm:ss",dateTemplate:"yy-mm-dd",timeFormat:"HH:mm:ss",dateFormat:"yy-mm-dd",minYear:"-99",maxYear:"+99",firstDay:0,timeOnly:false,showTime:false,addPopup:false,isRTL:false,customClass:null,firstItem:"empty",timezone:null,offset:null,target:null}})(jQuery);